************************************************************
OBJETO: Dataenvironment
************************************************************
*** PROPIEDADES ***
Top = 0
Left = 0
Width = 0
Height = 0
DataSource = .NULL.
Name = "Dataenvironment"

*** METODOS ***


************************************************************
OBJETO: FRM_CONS_ARTIC
************************************************************
*** PROPIEDADES ***
DoCreate = .T.
Name = "FRM_CONS_ARTIC"
contenido.Clsetiqueta1.Name = "Clsetiqueta1"
contenido.txtValorBuscado.Name = "txtValorBuscado"
contenido.grdArtic.COLUMN1.Header1.Name = "Header1"
contenido.grdArtic.COLUMN1.Text1.Name = "Text1"
contenido.grdArtic.COLUMN1.Name = "COLUMN1"
contenido.grdArtic.COLUMN2.Header1.Name = "Header1"
contenido.grdArtic.COLUMN2.Text1.Name = "Text1"
contenido.grdArtic.COLUMN2.Name = "COLUMN2"
contenido.grdArtic.COLUMN3.Header1.Name = "Header1"
contenido.grdArtic.COLUMN3.Text1.Name = "Text1"
contenido.grdArtic.COLUMN3.Name = "COLUMN3"
contenido.grdArtic.COLUMN4.Header1.Name = "Header1"
contenido.grdArtic.COLUMN4.Text1.Name = "Text1"
contenido.grdArtic.COLUMN4.Name = "COLUMN4"
contenido.grdArtic.COLUMN5.Header1.Name = "Header1"
contenido.grdArtic.COLUMN5.Text1.Name = "Text1"
contenido.grdArtic.COLUMN5.Name = "COLUMN5"
contenido.grdArtic.COLUMN6.Header1.Name = "Header1"
contenido.grdArtic.COLUMN6.Text1.Name = "Text1"
contenido.grdArtic.COLUMN6.Name = "COLUMN6"
contenido.grdArtic.COLUMN7.Header1.Name = "Header1"
contenido.grdArtic.COLUMN7.Text1.Name = "Text1"
contenido.grdArtic.COLUMN7.Name = "COLUMN7"
contenido.grdArtic.COLUMN8.Header1.Name = "Header1"
contenido.grdArtic.COLUMN8.Text1.Name = "Text1"
contenido.grdArtic.COLUMN8.Name = "COLUMN8"
contenido.grdArtic.COLUMN9.Header1.Name = "Header1"
contenido.grdArtic.COLUMN9.Text1.Name = "Text1"
contenido.grdArtic.COLUMN9.Name = "COLUMN9"
contenido.grdArtic.COLUMN10.Header1.Name = "Header1"
contenido.grdArtic.COLUMN10.Text1.Name = "Text1"
contenido.grdArtic.COLUMN10.Name = "COLUMN10"
contenido.grdArtic.COLUMN11.Header1.Name = "Header1"
contenido.grdArtic.COLUMN11.Text1.Name = "Text1"
contenido.grdArtic.COLUMN11.Name = "COLUMN11"
contenido.grdArtic.COLUMN12.Header1.Name = "Header1"
contenido.grdArtic.COLUMN12.Text1.Name = "Text1"
contenido.grdArtic.COLUMN12.Name = "COLUMN12"
contenido.grdArtic.COLUMN13.Header1.Name = "Header1"
contenido.grdArtic.COLUMN13.Text1.Name = "Text1"
contenido.grdArtic.COLUMN13.Name = "COLUMN13"
contenido.grdArtic.COLUMN14.Header1.Name = "Header1"
contenido.grdArtic.COLUMN14.Text1.Name = "Text1"
contenido.grdArtic.COLUMN14.Name = "COLUMN14"
contenido.grdArtic.COLUMN15.Header1.Name = "Header1"
contenido.grdArtic.COLUMN15.Text1.Name = "Text1"
contenido.grdArtic.COLUMN15.Name = "COLUMN15"
contenido.grdArtic.COLUMN16.Header1.Name = "Header1"
contenido.grdArtic.COLUMN16.Text1.Name = "Text1"
contenido.grdArtic.COLUMN16.Name = "COLUMN16"
contenido.grdArtic.COLUMN17.Header1.Name = "Header1"
contenido.grdArtic.COLUMN17.Text1.Name = "Text1"
contenido.grdArtic.COLUMN17.Name = "COLUMN17"
contenido.grdArtic.COLUMN18.Header1.Name = "Header1"
contenido.grdArtic.COLUMN18.Text1.Name = "Text1"
contenido.grdArtic.COLUMN18.Name = "COLUMN18"
contenido.grdArtic.COLUMN19.Header1.Name = "Header1"
contenido.grdArtic.COLUMN19.Text1.Name = "Text1"
contenido.grdArtic.COLUMN19.Name = "COLUMN19"
contenido.grdArtic.COLUMN20.Header1.Name = "Header1"
contenido.grdArtic.COLUMN20.Text1.Name = "Text1"
contenido.grdArtic.COLUMN20.Name = "COLUMN20"
contenido.grdArtic.Name = "grdArtic"
contenido.Clscerrar1.Name = "Clscerrar1"
contenido.Clsetiqueta2.Visible = .T.
contenido.Clsetiqueta2.Name = "Clsetiqueta2"
contenido.Clsetiqueta3.Visible = .T.
contenido.Clsetiqueta3.Name = "Clsetiqueta3"
contenido.Clsetiqueta4.Left = 715
contenido.Clsetiqueta4.Top = 348
contenido.Clsetiqueta4.Visible = .T.
contenido.Clsetiqueta4.Name = "Clsetiqueta4"
contenido.Clsetiqueta5.Visible = .T.
contenido.Clsetiqueta5.Name = "Clsetiqueta5"
contenido.txtPrVtaMay.Visible = .T.
contenido.txtPrVtaMay.Name = "txtPrVtaMay"
contenido.txtPrVtaMin.Visible = .T.
contenido.txtPrVtaMin.Name = "txtPrVtaMin"
contenido.txtPrFinalMay.Left = 846
contenido.txtPrFinalMay.Top = 343
contenido.txtPrFinalMay.Visible = .T.
contenido.txtPrFinalMay.Name = "txtPrFinalMay"
contenido.txtPrFinalMin.Visible = .T.
contenido.txtPrFinalMin.Name = "txtPrFinalMin"
contenido.Clsetiqueta6.Visible = .F.
contenido.Clsetiqueta6.Name = "Clsetiqueta6"
contenido.txtCostoRep.Visible = .T.
contenido.txtCostoRep.Name = "txtCostoRep"
contenido.Clsetiqueta7.Left = 253
contenido.Clsetiqueta7.Top = 445
contenido.Clsetiqueta7.Visible = .T.
contenido.Clsetiqueta7.Name = "Clsetiqueta7"
contenido.txtBonif1.Left = 299
contenido.txtBonif1.Top = 442
contenido.txtBonif1.Visible = .T.
contenido.txtBonif1.Name = "txtBonif1"
contenido.txtBonif2.Left = 353
contenido.txtBonif2.Top = 442
contenido.txtBonif2.Visible = .T.
contenido.txtBonif2.Name = "txtBonif2"
contenido.txtBonif3.Left = 407
contenido.txtBonif3.Top = 442
contenido.txtBonif3.Visible = .T.
contenido.txtBonif3.Name = "txtBonif3"
contenido.txtBonif4.Left = 457
contenido.txtBonif4.Top = 442
contenido.txtBonif4.Visible = .T.
contenido.txtBonif4.Name = "txtBonif4"
contenido.Clsetiqueta8.Visible = .T.
contenido.Clsetiqueta8.Name = "Clsetiqueta8"
contenido.txtListaProv.Visible = .T.
contenido.txtListaProv.Name = "txtListaProv"
contenido.Clsetiqueta9.Visible = .T.
contenido.Clsetiqueta9.Name = "Clsetiqueta9"
contenido.txtMargenMay.Visible = .T.
contenido.txtMargenMay.Name = "txtMargenMay"
contenido.Clsetiqueta10.Visible = .T.
contenido.Clsetiqueta10.Name = "Clsetiqueta10"
contenido.txtMargenMin.Visible = .T.
contenido.txtMargenMin.Name = "txtMargenMin"
contenido.Clsetiqueta11.Visible = .T.
contenido.Clsetiqueta11.Name = "Clsetiqueta11"
contenido.txtAlicIVA.Visible = .T.
contenido.txtAlicIVA.Name = "txtAlicIVA"
contenido.Clsetiqueta12.Left = 517
contenido.Clsetiqueta12.Top = 445
contenido.Clsetiqueta12.Visible = .T.
contenido.Clsetiqueta12.Name = "Clsetiqueta12"
contenido.txtCostoConIVA.Left = 648
contenido.txtCostoConIVA.Top = 440
contenido.txtCostoConIVA.Visible = .T.
contenido.txtCostoConIVA.Name = "txtCostoConIVA"
contenido.picFoto.Name = "picFoto"
contenido.Clsetiqueta13.Left = 715
contenido.Clsetiqueta13.Top = 371
contenido.Clsetiqueta13.Visible = .T.
contenido.Clsetiqueta13.Name = "Clsetiqueta13"
contenido.txtExistencia.Left = 846
contenido.txtExistencia.Top = 366
contenido.txtExistencia.Visible = .T.
contenido.txtExistencia.Name = "txtExistencia"
contenido.btnActualizar.Name = "btnActualizar"
contenido.BTNMOSTRARPRECIOS.Visible = .F.
contenido.BTNMOSTRARPRECIOS.Name = "BTNMOSTRARPRECIOS"
contenido.BTNEQUIVALENCIAS.Top = 469
contenido.BTNEQUIVALENCIAS.Left = 397
contenido.BTNEQUIVALENCIAS.Name = "BTNEQUIVALENCIAS"
contenido.Clsetiqueta14.Name = "Clsetiqueta14"
contenido.txtUltimaActualizacion.Name = "txtUltimaActualizacion"
contenido.Name = "contenido"
mov_stock.Name = "mov_stock"
FALTANTES.Name = "FALTANTES"

*** METODOS ***
PROCEDURE Init
LOCAL lcSql, oData

lcSql = "SELECT   	articulos.idArticulo, "
lcSql = lcSql + " 	articulos.codArt, "
lcSql = lcSql + " 	articulos.descripcio, "
lcSql = lcSql + "	marcas.descripcio as descMarca, "
lcSql = lcSql + " 	subfam.descripcio as descsubfam, "
lcSql = lcSql + " 	articulos.alicIVA, "
lcSql = lcSql + " 	articulos.prLista, "
lcSql = lcSql + " 	articulos.bonif1, "
lcSql = lcSql + " 	articulos.bonif2, "
lcSql = lcSql + " 	articulos.bonif3, "
lcSql = lcSql + " 	articulos.bonif4, "
lcSql = lcSql + " 	articulos.costoRep, " 
lcSql = lcSql + " 	articulos.margenMax, "
lcSql = lcSql + " 	articulos.margenMin, "
lcSql = lcSql + " 	articulos.prventaMax, "
lcSql = lcSql + " 	articulos.prventaMin, "
lcSql = lcSql + " 	articulos.prfinalMax, "
lcSql = lcSql + " 	articulos.prfinalMin, "
lcSql = lcSql + "	articulos.linkFoto, "
lcSql = lcSql + "	articulos.fecActuPre "
lcSql = lcSql + " FROM    articulos "
lcSql = lcSql + "		  INNER JOIN marcas ON  articulos.idmarca = marcas.idmarca "
lcSql = lcSql + "		  INNER JOIN subfam ON  articulos.idSubFam = subfam.idSubFam "
lcSql = lcSql + " WHERE articulos.fecBaja IS NULL "
lcSql = lcSql + " 		AND articulos.habilitado = 1 "


oData = CREATEOBJECT("odbc_Result")
oData.ActiveConnection = goConn.ActiveConnection
oData.cursor_name = "cur_Artic"
oData.OpenQuery(lcSql)

SELECT cur_Artic
INDEX ON idArticulo	TAG idArticulo	ASCENDING
INDEX ON descripcio TAG descripcio 	ASCENDING ADDITIVE
INDEX ON descMarca 	TAG descMarca	ASCENDING ADDITIVE
INDEX ON descsubfam	TAG descsubfam	ASCENDING ADDITIVE
INDEX ON alicIVA	TAG alicIVA		ASCENDING ADDITIVE
INDEX ON prLista	TAG prLista		ASCENDING ADDITIVE
INDEX ON bonif1		TAG bonif1 		ASCENDING ADDITIVE
INDEX ON bonif2		TAG bonif2		ASCENDING ADDITIVE
INDEX ON bonif3		TAG bonif3		ASCENDING ADDITIVE
INDEX ON bonif4 	TAG bonif4		ASCENDING ADDITIVE
INDEX ON costoRep	TAG costoRep	ASCENDING ADDITIVE
INDEX ON margenMax	TAG margenMax	ASCENDING ADDITIVE
INDEX ON margenMin 	TAG margenMin	ASCENDING ADDITIVE
INDEX ON prventaMax	TAG prventaMax	ASCENDING ADDITIVE
INDEX ON prventaMin TAG prventaMin 	ASCENDING ADDITIVE
INDEX ON prfinalMax	TAG prfinalMax	ASCENDING ADDITIVE
INDEX ON prfinalMin TAG prfinalMin	ASCENDING ADDITIVE
INDEX ON codArt 	TAG codArt 		ASCENDING ADDITIVE



SELECT cur_Artic
IF RECCOUNT() > 0
	GO TOP
	thisform.contenido.txtprVtaMay.Value = cur_Artic.prventaMax
	thisform.contenido.txtprFinalMin.Value = cur_Artic.prfinalMin
	thisform.contenido.txtprFinalMay.value = cur_Artic.prfinalMax
	thisform.contenido.txtPrVtaMin.Value = cur_Artic.prventaMin
	thisform.contenido.txtAlicIVA.Value = cur_Artic.alicIVA
	thisform.contenido.txtListaProv.Value = cur_Artic.prLista
	thisform.contenido.txtBonif1.Value = cur_Artic.bonif1
	thisform.contenido.txtBonif2.Value = cur_Artic.bonif2
	thisform.contenido.txtBonif3.Value = cur_Artic.bonif3
	thisform.contenido.txtBonif4.Value = cur_Artic.bonif4
	thisform.contenido.txtCostoRep.Value = cur_Artic.costoRep
	thisform.contenido.txtMargenMay.value = cur_Artic.margenMax
	Thisform.contenido.txtMargenMin.Value = cur_Artic.MargenMin

	thisform.contenido.txtCostoConIVA.Value = ROUND(cur_Artic.CostoRep + (cur_Artic.CostoRep * (thisform.contenido.txtAlicIVA.Value / 100)), 2)
	thisform.contenido.picFoto.Picture = IIF(ISNULL(cur_Artic.linkfoto), "", cur_Artic.linkfoto)
ENDIF


SELECT cur_Artic
Thisform.contenido.grdArtic.RecordSource = "cur_Artic"
Thisform.contenido.grdArtic.list_controlsource = "codArt,descripcio,descMarca,descsubfam,prventaMax,prfinalMax"
Thisform.contenido.grdArtic.lista_ancho_cols = "150,350,150,180,80,80"
Thisform.contenido.grdArtic.titulos_cabeceras = "Código,Descripción,Marca,SubFamilia,Venta May.,c/IVA May."
Thisform.contenido.grdArtic.generar_grid()

ENDPROC


************************************************************
OBJETO: 
************************************************************
*** PROPIEDADES ***
Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 8, 5, 14, 11, 29, 3, 0

*** METODOS ***


