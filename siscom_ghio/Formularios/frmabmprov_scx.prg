************************************************************
OBJETO: Dataenvironment
************************************************************
*** PROPIEDADES ***
Top = 0
Left = 0
Width = 0
Height = 0
DataSource = .NULL.
Name = "Dataenvironment"

*** METODOS ***


************************************************************
OBJETO: FRMABMPROV
************************************************************
*** PROPIEDADES ***
BorderStyle = 2
Height = 522
Width = 818
DoCreate = .T.
Caption = "ABM Proveedores"
cotizac_ant = 0.00
cnombretabla = proveedor
listctrlsource = idProv,razsoc,nomfant,telefono
listwidthcols = 70,200,200,150
obj_dataservicename = datObject
pk_fieldname = idProv
titulos_cabeceras = Código,Razón Social, Nombre Fantasía, Telefono
Name = "FRMABMPROV"
Herramientas.cmdNuevo.Name = "cmdNuevo"
Herramientas.cmdEditar.Name = "cmdEditar"
Herramientas.cmdEliminar.Name = "cmdEliminar"
Herramientas.cmdCerrar.Name = "cmdCerrar"
Herramientas.cmdGrabar.Name = "cmdGrabar"
Herramientas.cmdCancelar.Name = "cmdCancelar"
Herramientas.cmdExcel.Name = "cmdExcel"
Herramientas.autoassing = .T.
Herramientas.Name = "Herramientas"
Pgf.ErasePage = .T.
Pgf.Page1.grdDatos.COLUMN1.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN1.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN1.Name = "COLUMN1"
Pgf.Page1.grdDatos.COLUMN2.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN2.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN2.Name = "COLUMN2"
Pgf.Page1.grdDatos.COLUMN3.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN3.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN3.Name = "COLUMN3"
Pgf.Page1.grdDatos.COLUMN4.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN4.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN4.Name = "COLUMN4"
Pgf.Page1.grdDatos.COLUMN5.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN5.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN5.Name = "COLUMN5"
Pgf.Page1.grdDatos.COLUMN6.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN6.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN6.Name = "COLUMN6"
Pgf.Page1.grdDatos.COLUMN7.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN7.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN7.Name = "COLUMN7"
Pgf.Page1.grdDatos.COLUMN8.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN8.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN8.Name = "COLUMN8"
Pgf.Page1.grdDatos.COLUMN9.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN9.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN9.Name = "COLUMN9"
Pgf.Page1.grdDatos.COLUMN10.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN10.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN10.Name = "COLUMN10"
Pgf.Page1.grdDatos.COLUMN11.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN11.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN11.Name = "COLUMN11"
Pgf.Page1.grdDatos.COLUMN12.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN12.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN12.Name = "COLUMN12"
Pgf.Page1.grdDatos.COLUMN13.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN13.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN13.Name = "COLUMN13"
Pgf.Page1.grdDatos.COLUMN14.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN14.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN14.Name = "COLUMN14"
Pgf.Page1.grdDatos.COLUMN15.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN15.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN15.Name = "COLUMN15"
Pgf.Page1.grdDatos.COLUMN16.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN16.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN16.Name = "COLUMN16"
Pgf.Page1.grdDatos.COLUMN17.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN17.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN17.Name = "COLUMN17"
Pgf.Page1.grdDatos.COLUMN18.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN18.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN18.Name = "COLUMN18"
Pgf.Page1.grdDatos.COLUMN19.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN19.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN19.Name = "COLUMN19"
Pgf.Page1.grdDatos.COLUMN20.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN20.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN20.Name = "COLUMN20"
Pgf.Page1.grdDatos.Height = 443
Pgf.Page1.grdDatos.Left = 2
Pgf.Page1.grdDatos.Top = 3
Pgf.Page1.grdDatos.Width = 808
Pgf.Page1.grdDatos.Name = "grdDatos"
Pgf.Page1.Name = "Page1"
Pgf.Page2.cnt_fields.Top = 7
Pgf.Page2.cnt_fields.Left = 9
Pgf.Page2.cnt_fields.Width = 794
Pgf.Page2.cnt_fields.Height = 435
Pgf.Page2.cnt_fields.Name = "cnt_fields"
Pgf.Page2.Name = "Page2"
Pgf.Top = 39
Pgf.Left = 2
Pgf.Width = 819
Pgf.Height = 478
Pgf.Name = "Pgf"

*** METODOS ***
PROCEDURE recalcular_lista_cbio
&& Permite recalcular la lista de preicos cunado el usuario
&& cambia el valor de cambio de moneda extranjera.

LOCAL resArtic, lcSql, loCommand, loProgress
LOCAL ln_IdArticulo
LOCAL ln_PrListaExt, ln_AlicIVA, ln_Cotizac, ln_prLista
LOCAL ln_Bonif1, ln_Bonif2, ln_Bonif3, ln_Bonif4, ln_CostoRep
LOCAL lnMargenMax, ln_MargenMin, ln_PrVentaMax, ln_PrVentaMin
LOCAL ln_PrFinalMax, ln_PrFinalMin

&& Inicializo las variables

loProgress = CREATEOBJECT("_thermometer")
lnCont = 0
lnPorc = 0.00
resArtic = CREATEOBJECT("odbc_result")
lcSql = ""
loCommand = CREATEOBJECT("odbc_command")

ln_IdArticulo = 0
ln_PrListaExt = 0.00
ln_AlicIVA = 0.00
ln_Cotizac = Thisform.pgf.page2.cnt_fields.txtCotiza.Value
ln_prLista = 0.00
ln_Bonif1 = 0.00
ln_Bonif2 = 0.00
ln_Bonif3 = 0.00
ln_Bonif4 = 0.00
ln_CostoRep = 0.00
lnMargenMax = 0.00
ln_MargenMin = 0.00
ln_PrVentaMax = 0.00
ln_PrVentaMin = 0.00
ln_PrFinalMax = 0.00
ln_PrFinalMin = 0.00

SELECT cur_Tempo
lcSql = "SELECT * FROM articulos WHERE idprov = " + ALLTRIM(STR(cur_Tempo.idprov)) + " "
lcSql = lcSql + " AND articulos.tmon <> 'PSO'"
resArtic.ActiveConnection = goConn.ActiveConnection
resArtic.Cursor_Name = "cur_artic"
resArtic.OpenQuery(lcSql)

loProgress.show()

SELECT cur_Artic
IF RECCOUNT() > 0
	GO TOP
ENDIF

SELECT cur_Artic
DO WHILE !EOF()
	ln_IdArticulo = cur_Artic.idArticulo
	ln_PrListaExt = cur_Artic.prListaExt
	ln_AlicIVA = cur_Artic.alicIVA
	ln_prLista = cur_Artic.prLista
	ln_Bonif1 = cur_Artic.Bonif1
	ln_Bonif2 = cur_Artic.Bonif2
	ln_Bonif3 = cur_Artic.Bonif3
	ln_Bonif4 = cur_Artic.Bonif4
	ln_CostoRep = cur_Artic.costoRep
	ln_MargenMax = cur_Artic.margenMax
	ln_MargenMin = cur_Artic.margenMin
	ln_PrVentaMax = cur_Artic.prVentaMax
	ln_PrVentaMin = cur_Artic.prVentaMin
	ln_PrFinalMax = cur_Artic.prFinalMax
	ln_PrFinalMin = cur_Artic.prFinalMin
	
	ln_PrLista = ln_PrListaExt * ln_Cotizac
	ln_CostoRep = calcular_costo(ln_PrLista, ln_Bonif1, ln_Bonif2, ln_Bonif3, ln_Bonif4, 0)
	ln_PrVentaMax = calcular_venta(ln_CostoRep, ln_MargenMax, 0)
	ln_PrVentaMin = calcular_venta(ln_CostoRep, ln_MargenMin, 0)
	ln_PrFinalMax = ROUND(ln_PrVentaMax + (ln_PrVentaMax * (ln_AlicIVA / 100)), 2)
	ln_PrFinalMin = ROUND(ln_PrVentaMin + (ln_PrVentaMin * (ln_AlicIVA / 100)), 2)
	
	lcSql = "update articulos set "
	lcSql = lcSql + " cotizac = " + STR(ln_Cotizac, 10, 2) + ", "
	lcSql = lcSql + " prLista = " + STR(ln_PrLista, 10, 2) + ", "
	lcSql = lcSql + " CostoRep = " + STR(ln_CostoRep, 10, 2) + ", "
	lcSql = lcSql + " PrVentaMax = " + STR(ln_PrVentaMax, 10, 2) + ", "
	lcSql = lcSql + " PrVentaMin = " + STR(ln_PrVentaMin, 10, 2) + ", "
	lcSql = lcSql + " PrFinalMax = " + STR(ln_PrFinalMax, 10, 2) + ", "
	lcSql = lcSql + " PrFinalMin = " + STR(ln_PrFinalMin, 10, 2) + " "
	lcSql = lcSql + "WHERE idArticulo = " + ALLTRIM(STR(ln_IdArticulo))
	
	loCommand.ActiveConnection = goConn.ActiveConnection
	loCommand.CommandText = lcSql
	IF !loCommand.execute()
		resArtic.close_query()
		MESSAGEBOX("Error al actualizar la lista de precios", 0+64, Thisform.Caption)
		RETURN .F.
	ENDIF
	
	lnCont = lnCont + 1
	lnPorc = (lnCont * 100) / RECCOUNT()
	loProgress.update(lnPorc)
	
	SELECT cur_Artic
	SKIP
ENDDO

resArtic.close_query()
loProgress.complete()

RETURN .T.

ENDPROC
PROCEDURE Init
DODEFAULT()

thisform.pgf.page2.cnt_fields.cmbTipoMoneda.AddItem("PSO")
thisform.pgf.page2.cnt_fields.cmbTipoMoneda.AddItem("DOL")
thisform.pgf.page2.cnt_fields.cmbTipoMoneda.AddItem("EUR")

thisform.pgf.page2.cnt_fields.cmbTipoMoneda.ListIndex = 1
ENDPROC
PROCEDURE recuperardatos
LOCAL loLoc, loPcia, lcSql

DODEFAULT()

lcSql = "select * from localidad where idlocalid = " + ALLTRIM(STR(thisform.pgf.page2.cnt_fields.sel_Localid.valcpoid))

loLoc = CREATEOBJECT("odbc_Result")
loLoc.ActiveConnection = goConn.ActiveConnection
loLoc.Cursor_Name = "cur_Localidad"
loLoc.OpenQuery(lcSql)

SELECT cur_Localidad
lcSql = "select * from provincias where idprovin = " + ALLTRIM(STR(cur_Localidad.idProvin))
loPcia = CREATEOBJECT("odbc_Result")
loPcia.ActiveConnection = goConn.ActiveConnection
loPcia.Cursor_Name = "cur_pcia"
loPcia.OpenQuery(lcSql)

SELECT cur_pcia
thisform.pgf.page2.cnt_fields.txtProvincia.Value = cur_pcia.descripcio
loPcia.close_query()

loLoc.close_query()

Thisform.cotizac_ant = cur_Tempo.cotizac
ENDPROC
PROCEDURE validar_eliminar
LOCAL lcSql, oResult

SELECT cur_Tempo
lcSql = "SELECT COUNT(*) AS Cant FROM articulos WHERE idProv = " + ALLTRIM(STR(cur_Tempo.IdProv))

oResult = CREATEOBJECT("odbc_Result")
oResult.ActiveConnection = goConn.ActiveConnection
oResult.Cursor_Name = "cur_Art"
oResult.OpenQuery(lcSql)

SELECT cur_Art

IF VAL(cur_Art.Cant) > 0
	MESSAGEBOX("No se puede eliminar, este proveedor tiene artículos cargados", 0+64, Thisform.Caption)
	oResult.close_query()
	RETURN .F.
ENDIF

oResult.close_query()
RETURN .T.

ENDPROC
PROCEDURE Herramientas.cmdGrabar.Click
LOCAL lnResp

IF !Thisform.lnuevo
	IF thisform.cotizac_ant <> thisform.pgf.page2.cnt_fields.txtCotiza.Value
		lnResp = MESSAGEBOX("Se ha detectado que la cotización ha cambiado, desea actualizar la lista de este proveedor", 4+32, Thisform.Caption)
		IF lnResp = 6
			Thisform.recalcular_lista_cbio()
		ENDIF
	ENDIF
ENDIF

DODEFAULT()
ENDPROC
PROCEDURE Herramientas.nuevo
DODEFAULT()
thisform.pgf.page2.cnt_fields.cmbTipoMoneda.ListIndex = 1

ENDPROC


************************************************************
OBJETO: Clsetiqueta2
************************************************************
*** PROPIEDADES ***
Caption = "Razón Social:"
Left = 12
Top = 14
TabIndex = 20
Name = "Clsetiqueta2"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta3
************************************************************
*** PROPIEDADES ***
Caption = "Nom. Fantasía:"
Left = 12
Top = 38
TabIndex = 21
Name = "Clsetiqueta3"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta4
************************************************************
*** PROPIEDADES ***
Caption = "Dirección:"
Left = 12
Top = 60
TabIndex = 22
Name = "Clsetiqueta4"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta6
************************************************************
*** PROPIEDADES ***
Caption = "Código Postal:"
Left = 12
Top = 84
TabIndex = 23
Name = "Clsetiqueta6"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta7
************************************************************
*** PROPIEDADES ***
Caption = "Provincia:"
Height = 15
Left = 12
Top = 106
Width = 58
TabIndex = 24
Name = "Clsetiqueta7"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta8
************************************************************
*** PROPIEDADES ***
Caption = "Teléfono:"
Left = 12
Top = 130
TabIndex = 25
Name = "Clsetiqueta8"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta9
************************************************************
*** PROPIEDADES ***
Caption = "EMail:"
Height = 15
Left = 13
Top = 155
Width = 34
TabIndex = 26
Name = "Clsetiqueta9"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta10
************************************************************
*** PROPIEDADES ***
Caption = "Página Web:"
Left = 12
Top = 178
TabIndex = 27
Name = "Clsetiqueta10"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta11
************************************************************
*** PROPIEDADES ***
Caption = "Cond. de Pago:"
Left = 12
Top = 251
TabIndex = 28
Name = "Clsetiqueta11"

*** METODOS ***


************************************************************
OBJETO: sel_SitIVA
************************************************************
*** PROPIEDADES ***
Top = 220
Left = 106
TabIndex = 11
cfieldname = idsitiva
msgerror = Debe ingresar la Situación de I.V.A.
nombre_campo_codigo = idsitiva
nombre_campo_desc = descripcio
nombre_tabla = sitiva
pkfield = idsitiva
esnumerico = .T.
Name = "sel_SitIVA"
txtCodigo.Name = "txtCodigo"
txtDescripcion.Name = "txtDescripcion"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta14
************************************************************
*** PROPIEDADES ***
Caption = "Situación I.V.A.:"
Left = 11
Top = 227
TabIndex = 29
Name = "Clsetiqueta14"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta15
************************************************************
*** PROPIEDADES ***
Caption = "C.U.I.T.:"
Height = 15
Left = 594
Top = 227
Width = 48
TabIndex = 30
Name = "Clsetiqueta15"

*** METODOS ***


************************************************************
OBJETO: txtRazSoc
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 108
TabIndex = 1
Top = 10
Width = 672
cfieldname = razsoc
msgerror = Debe ingresar la Razón Social
ischaracter = .T.
Name = "txtRazSoc"

*** METODOS ***


************************************************************
OBJETO: txtNomFant
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 108
TabIndex = 2
Top = 33
Width = 672
cfieldname = nomfant
ischaracter = .T.
msgerror = Debe ingresar el Nombre Fantasía
Name = "txtNomFant"

*** METODOS ***


************************************************************
OBJETO: txtDireccion
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 108
TabIndex = 3
Top = 56
Width = 672
cfieldname = direccion
ischaracter = .T.
msgerror = Debe ingresar la Dirección
Name = "txtDireccion"

*** METODOS ***


************************************************************
OBJETO: txtTelefono
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 108
TabIndex = 6
Top = 126
Width = 312
cfieldname = telefono
ischaracter = .T.
msgerror = Debe ingresar el Teléfono
requerido = .F.
Name = "txtTelefono"

*** METODOS ***


************************************************************
OBJETO: txtEmail
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 108
TabIndex = 8
Top = 150
Width = 478
cfieldname = email
ischaracter = .T.
requerido = .F.
msgerror = Debe ingresar el Email
Name = "txtEmail"

*** METODOS ***


************************************************************
OBJETO: txtpagWeb
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 108
TabIndex = 9
Top = 174
Width = 672
requerido = .F.
cfieldname = pagweb
ischaracter = .T.
msgerror = Debe ingresar la Página Web
Name = "txtpagWeb"

*** METODOS ***


************************************************************
OBJETO: sel_CondPago
************************************************************
*** PROPIEDADES ***
Top = 244
Left = 106
Width = 482
Height = 25
TabIndex = 13
cfieldname = idcondpago
msgerror = Debe ingresar la Condición de Pago
nombre_campo_codigo = idcondpago
nombre_campo_desc = descripcio
nombre_tabla = condpagos
pkfield = idcondpago
requerido = .T.
esnumerico = .T.
Name = "sel_CondPago"
txtCodigo.Name = "txtCodigo"
txtDescripcion.Name = "txtDescripcion"

*** METODOS ***


************************************************************
OBJETO: txtNroCuit
************************************************************
*** PROPIEDADES ***
Height = 21
InputMask = ""
Left = 641
MaxLength = 0
TabIndex = 12
Top = 222
Width = 139
cfieldname = nrocuit
ischaracter = .T.
msgerror = Debe ingresar el número de C.U.I.T.
Name = "txtNroCuit"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta20
************************************************************
*** PROPIEDADES ***
Caption = "Observaciones:"
Height = 14
Left = 12
Top = 299
Width = 96
TabIndex = 31
Name = "Clsetiqueta20"

*** METODOS ***


************************************************************
OBJETO: txtObserv
************************************************************
*** PROPIEDADES ***
Height = 57
Left = 108
TabIndex = 15
Top = 294
Width = 672
cfieldname = observ
Name = "txtObserv"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta19
************************************************************
*** PROPIEDADES ***
Caption = "Fax:"
Height = 14
Left = 428
Top = 130
Width = 24
TabIndex = 35
Name = "Clsetiqueta19"

*** METODOS ***


************************************************************
OBJETO: txtFax
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 456
TabIndex = 7
Top = 126
Width = 324
cfieldname = fax
requerido = .F.
ischaracter = .T.
msgerror = Debe ingresar el Fax
Name = "txtFax"

*** METODOS ***


************************************************************
OBJETO: Sel_Localid
************************************************************
*** PROPIEDADES ***
Top = 77
Left = 106
TabIndex = 4
cfieldname = idLocalid
msgerror = Debe ingresar el Código Postal
nombre_campo_codigo = codpostal
nombre_campo_desc = descripcio
nombre_tabla = localidad
pkfield = idlocalid
esnumerico = .F.
Name = "Sel_Localid"
txtCodigo.Name = "txtCodigo"
txtDescripcion.Name = "txtDescripcion"

*** METODOS ***
PROCEDURE recuperar_datos
LOCAL lcSql, loPcia

SELECT localidad
lcSql = "select * from provincias where idprovin = " + ALLTRIM(STR(localidad.idprovin))
loPcia = CREATEOBJECT("odbc_Result")
loPcia.ActiveConnection = goConn.ActiveConnection
loPcia.cursor_name = "cur_pcia"
loPcia.OpenQuery(lcSql)

SELECT cur_pcia
IF RECCOUNT() > 0
	thisform.pgf.page2.cnt_fields.txtProvincia.Value = cur_pcia.descripcio
ENDIF

loPcia.Close_Query()
ENDPROC


************************************************************
OBJETO: Clsetiqueta1
************************************************************
*** PROPIEDADES ***
Caption = "Contacto:"
Left = 12
Top = 202
TabIndex = 36
Name = "Clsetiqueta1"

*** METODOS ***


************************************************************
OBJETO: txtContacto
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 108
TabIndex = 10
Top = 198
Width = 478
requerido = .F.
cfieldname = contacto
ischaracter = .T.
msgerror = Debe ingresar el Contacto
Name = "txtContacto"

*** METODOS ***


************************************************************
OBJETO: chkHabilitado
************************************************************
*** PROPIEDADES ***
Top = 357
Left = 396
Height = 18
Width = 125
Alignment = 0
Caption = "Habilitado"
TabIndex = 18
cfieldname = habilitado
Name = "chkHabilitado"

*** METODOS ***


************************************************************
OBJETO: txtProvincia
************************************************************
*** PROPIEDADES ***
Tag = "noedit"
Height = 21
Left = 108
ReadOnly = .T.
TabIndex = 5
Top = 102
Width = 672
cfieldname = 
ischaracter = .T.
msgerror = 
requerido = .F.
Name = "txtProvincia"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta5
************************************************************
*** PROPIEDADES ***
Caption = "Tipo de Moneda:"
Height = 14
Left = 12
Top = 358
Width = 96
TabIndex = 33
Name = "Clsetiqueta5"

*** METODOS ***


************************************************************
OBJETO: cmbTipoMoneda
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 109
TabIndex = 16
Top = 354
Width = 100
cfieldname = tMon
requerido = .F.
Name = "cmbTipoMoneda"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta12
************************************************************
*** PROPIEDADES ***
Caption = "Cotización:"
Height = 14
Left = 216
Top = 359
Width = 72
TabIndex = 34
Name = "Clsetiqueta12"

*** METODOS ***


************************************************************
OBJETO: txtCotiza
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 288
TabIndex = 17
Top = 354
Width = 100
isnumeric = .T.
requerido = .F.
cfieldname = cotizac
Name = "txtCotiza"

*** METODOS ***
PROCEDURE LostFocus
DODEFAULT()

ENDPROC


************************************************************
OBJETO: btnConsCUIT
************************************************************
*** PROPIEDADES ***
Top = 244
Left = 625
Height = 24
Width = 156
Caption = "Constancia de Inscripción"
TabIndex = 19
Name = "btnConsCUIT"

*** METODOS ***
PROCEDURE Click
DO FORM "frmConsCUIT"
ENDPROC


************************************************************
OBJETO: Clsetiqueta13
************************************************************
*** PROPIEDADES ***
Caption = "Transporte:"
Left = 12
Top = 274
TabIndex = 32
Name = "Clsetiqueta13"

*** METODOS ***


************************************************************
OBJETO: Selector_tabla1
************************************************************
*** PROPIEDADES ***
Top = 268
Left = 106
TabIndex = 14
cfieldname = idTransp
msgerror = Debe ingresar el transporte
nombre_campo_codigo = codTrans
nombre_campo_desc = razSoc
nombre_tabla = transp
pkfield = idTransp
esnumerico = .T.
requerido = .T.
Name = "Selector_tabla1"
TXTCODIGO.Name = "TXTCODIGO"
TXTDESCRIPCION.Name = "TXTDESCRIPCION"

*** METODOS ***
PROCEDURE recuperar_datos
LOCAL lcSql, loPcia

SELECT localidad
lcSql = "select * from provincias where idprovin = " + ALLTRIM(STR(localidad.idprovin))
loPcia = CREATEOBJECT("odbc_Result")
loPcia.ActiveConnection = goConn.ActiveConnection
loPcia.cursor_name = "cur_pcia"
loPcia.OpenQuery(lcSql)

SELECT cur_pcia
IF RECCOUNT() > 0
	thisform.pgf.page2.cnt_fields.txtProvincia.Value = cur_pcia.descripcio
ENDIF

loPcia.Close_Query()
ENDPROC


************************************************************
OBJETO: 
************************************************************
*** PROPIEDADES ***
Arial, 0, 8, 5, 14, 11, 29, 3, 0
Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 8, 5, 14, 11, 29, 3, 0

*** METODOS ***


