************************************************************
OBJETO: Dataenvironment
************************************************************
*** PROPIEDADES ***
Top = 0
Left = 0
Width = 0
Height = 0
DataSource = .NULL.
Name = "Dataenvironment"

*** METODOS ***


************************************************************
OBJETO: FRMABMARTICULOS
************************************************************
*** PROPIEDADES ***
Height = 571
Width = 946
DoCreate = .T.
Caption = "ABM Artículos"
WindowState = 0
cnombretabla = articulos
listctrlsource = Codart,Descripcio
listwidthcols = 150,400
obj_dataservicename = datobject
pk_fieldname = idarticulo
titulos_cabeceras = Código,Descripción
Name = "FRMABMARTICULOS"
Herramientas.cmdNuevo.Top = 1
Herramientas.cmdNuevo.Left = 6
Herramientas.cmdNuevo.Height = 34
Herramientas.cmdNuevo.Width = 39
Herramientas.cmdNuevo.Name = "cmdNuevo"
Herramientas.cmdEditar.Top = 1
Herramientas.cmdEditar.Left = 46
Herramientas.cmdEditar.Height = 34
Herramientas.cmdEditar.Width = 39
Herramientas.cmdEditar.Name = "cmdEditar"
Herramientas.cmdEliminar.Top = 1
Herramientas.cmdEliminar.Left = 86
Herramientas.cmdEliminar.Height = 34
Herramientas.cmdEliminar.Width = 39
Herramientas.cmdEliminar.Name = "cmdEliminar"
Herramientas.cmdCerrar.Top = 1
Herramientas.cmdCerrar.Left = 899
Herramientas.cmdCerrar.Height = 33
Herramientas.cmdCerrar.Width = 36
Herramientas.cmdCerrar.Name = "cmdCerrar"
Herramientas.cmdGrabar.Top = 1
Herramientas.cmdGrabar.Left = 126
Herramientas.cmdGrabar.Height = 34
Herramientas.cmdGrabar.Width = 39
Herramientas.cmdGrabar.Name = "cmdGrabar"
Herramientas.cmdCancelar.Top = 1
Herramientas.cmdCancelar.Left = 166
Herramientas.cmdCancelar.Height = 34
Herramientas.cmdCancelar.Width = 39
Herramientas.cmdCancelar.Name = "cmdCancelar"
Herramientas.CMDEXCEL.Name = "CMDEXCEL"
Herramientas.Top = 1
Herramientas.Left = 2
Herramientas.Width = 939
Herramientas.Height = 36
Herramientas.Name = "Herramientas"
Pgf.ErasePage = .T.
Pgf.Page1.grdDatos.COLUMN1.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN1.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN1.Name = "COLUMN1"
Pgf.Page1.grdDatos.COLUMN2.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN2.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN2.Name = "COLUMN2"
Pgf.Page1.grdDatos.COLUMN3.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN3.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN3.Name = "COLUMN3"
Pgf.Page1.grdDatos.COLUMN4.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN4.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN4.Name = "COLUMN4"
Pgf.Page1.grdDatos.COLUMN5.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN5.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN5.Name = "COLUMN5"
Pgf.Page1.grdDatos.COLUMN6.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN6.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN6.Name = "COLUMN6"
Pgf.Page1.grdDatos.COLUMN7.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN7.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN7.Name = "COLUMN7"
Pgf.Page1.grdDatos.COLUMN8.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN8.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN8.Name = "COLUMN8"
Pgf.Page1.grdDatos.COLUMN9.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN9.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN9.Name = "COLUMN9"
Pgf.Page1.grdDatos.COLUMN10.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN10.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN10.Name = "COLUMN10"
Pgf.Page1.grdDatos.COLUMN11.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN11.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN11.Name = "COLUMN11"
Pgf.Page1.grdDatos.COLUMN12.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN12.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN12.Name = "COLUMN12"
Pgf.Page1.grdDatos.COLUMN13.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN13.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN13.Name = "COLUMN13"
Pgf.Page1.grdDatos.COLUMN14.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN14.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN14.Name = "COLUMN14"
Pgf.Page1.grdDatos.COLUMN15.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN15.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN15.Name = "COLUMN15"
Pgf.Page1.grdDatos.COLUMN16.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN16.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN16.Name = "COLUMN16"
Pgf.Page1.grdDatos.COLUMN17.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN17.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN17.Name = "COLUMN17"
Pgf.Page1.grdDatos.COLUMN18.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN18.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN18.Name = "COLUMN18"
Pgf.Page1.grdDatos.COLUMN19.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN19.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN19.Name = "COLUMN19"
Pgf.Page1.grdDatos.COLUMN20.Header1.Name = "Header1"
Pgf.Page1.grdDatos.COLUMN20.Text1.Name = "Text1"
Pgf.Page1.grdDatos.COLUMN20.Name = "COLUMN20"
Pgf.Page1.grdDatos.Height = 501
Pgf.Page1.grdDatos.Left = 2
Pgf.Page1.grdDatos.Top = 3
Pgf.Page1.grdDatos.Width = 935
Pgf.Page1.grdDatos.Name = "grdDatos"
Pgf.Page1.Name = "Page1"
Pgf.Page2.cnt_fields.Top = 7
Pgf.Page2.cnt_fields.Left = 9
Pgf.Page2.cnt_fields.Width = 924
Pgf.Page2.cnt_fields.Height = 493
Pgf.Page2.cnt_fields.Name = "cnt_fields"
Pgf.Page2.Name = "Page2"
Pgf.Top = 40
Pgf.Left = 0
Pgf.Width = 944
Pgf.Height = 531
Pgf.Name = "Pgf"

*** METODOS ***
PROCEDURE calcular_precios
LOCAL ln_prlista, ln_bonif1, ln_bonif2, ln_bonif3, ln_bonif4, ln_costo
LOCAL ln_aliciva, ln_margenmax, ln_margenmin, ln_prventamax, ln_prventamin, ln_prfinalmax, ln_prfinalmin

ln_costo = 0.00
ln_prventamax = 0.00
ln_prventamin = 0.00
ln_prfinalmax = 0.00
ln_prfinalmin = 0.00

WITH Thisform.pgf.page2.cnt_fields.internalPgf.page1
	ln_prlista 		= .txtPrLista.value
	ln_bonif1 		= .txtBonif1.value
	ln_bonif2 		= .txtBonif2.value
	ln_bonif3 		= .txtBonif3.value
	ln_bonif4 		= .txtBonif4.value
	ln_aliciva 	 	= Thisform.pgf.page2.cnt_fields.txtAlicIVA.Value
	ln_margenmax 	= .txtMargenMax.value
	ln_margenmin	= .txtMargenMin.value
ENDWITH

ln_costo = ln_prlista - (ln_prlista * (ln_bonif1 / 100))
ln_costo = ln_costo - (ln_costo * (ln_bonif2 / 100))
ln_costo = ln_costo - (ln_costo * (ln_bonif3 / 100))
ln_costo = ln_costo - (ln_costo * (ln_bonif4 / 100))

ln_prventamax = ln_costo + (ln_costo * (ln_margenmax / 100))
ln_prventamin = ln_costo + (ln_costo * (ln_margenmin / 100))

ln_prfinalmax = ln_prventamax + (ln_prventamax * (ln_aliciva / 100))
ln_prfinalmin = ln_prventamin + (ln_prventamin * (ln_aliciva / 100))

Thisform.pgf.page2.cnt_fields.internalPgf.page1.txtCostoRep.Value = ROUND(ln_costo, 2)
Thisform.pgf.page2.cnt_fields.internalPgf.page1.txtPrVentaMax.Value = ROUND(ln_prventamax , 2)
Thisform.pgf.page2.cnt_fields.internalPgf.page1.txtPrVentaMin.Value = ROUND(ln_prventamin , 2)
Thisform.pgf.page2.cnt_fields.internalPgf.page1.txtPrFinalMax.Value = ROUND(ln_prfinalmax , 2)
Thisform.pgf.page2.cnt_fields.internalPgf.page1.txtPrFinalMin.Value = ROUND(ln_prfinalmin , 2)
ENDPROC
PROCEDURE cambiar_estado_2
PARAMETERS tl_Estado

Thisform.Pgf.Page2.cnt_fields.InternalPgf.Enabled = .T.
Thisform.Pgf.Page2.cnt_fields.InternalPgf.Page1.Enabled = .T.
Thisform.Pgf.Page2.cnt_fields.InternalPgf.Page2.Enabled = .T.

WITH Thisform.Pgf.Page2.cnt_Fields.INternalPgf.Page1
	FOR EACH ctrl IN .Controls
		ctrl.Enabled = IIF(ALLTRIM(ctrl.Tag)=="no_edit", tl_Estado, !tl_Estado)
	ENDFOR
ENDWITH

WITH Thisform.Pgf.Page2.cnt_Fields.INternalPgf.Page2
	FOR EACH ctrl IN .Controls
		ctrl.Enabled = IIF(ALLTRIM(ctrl.Tag)=="no_edit", tl_Estado, !tl_Estado)
	ENDFOR
ENDWITH
ENDPROC
PROCEDURE validardatos
DODEFAULT()

IF Thisform.Pgf.Page2.cnt_Fields.sel_Familia.txtCodigo.Value = 0 THEN
	RETURN .F.
ENDIF

IF Thisform.Pgf.Page2.cnt_FIELDS.sel_SubFamilia.txtCodigo.Value = 0 THEN
	RETURN .F.
ENDIF

IF Thisform.Pgf.Page2.cnt_Fields.sel_Marca.txtCodigo.Value = 0 THEN
	RETURN .F.
ENDIF

IF Thisform.Pgf.Page2.cnt_Fields.sel_Proveedor.txtCodigo.Value = 0 THEN
	RETURN .F.
ENDIF

RETURN .T.
ENDPROC
PROCEDURE recuperardatos
LOCAL lcReferencia, lnCont, lcFieldName
DIMENSION laCampos[1]

&&Recupero los datos de la solapa "Precios"
SELECT cur_Tempo

WITH Thisform.Pgf.Page2.cnt_fields.internalPgf.page1
	lnCont = AFIELDS(laCampos)
	
	FOR i = 1 TO lnCont
		FOR EACH ctrl IN .Controls
			lcFieldName = laCampos[i, 1]
			lcReferencia = "cur_Tempo." + ALLTRIM(lcFieldName)

			DO CASE 
				CASE LOWER(ctrl.BaseClass) == "textbox"
					IF LOWER(ALLTRIM(ctrl.cFieldName)) == LOWER(ALLTRIM(lcFieldName))
						ctrl.value = &lcReferencia
					ENDIF			
				CASE LOWER(ctrl.BaseClass) == "combobox"
					IF LOWER(ALLTRIM(ctrl.cFieldName)) == LOWER(ALLTRIM(lcFieldName))
						ctrl.value = &lcReferencia
					ENDIF			
				CASE LOWER(ctrl.BaseClass) == "editbox"
					IF LOWER(ALLTRIM(ctrl.cFieldName)) == LOWER(ALLTRIM(lcFieldName))
						ctrl.value = &lcReferencia
					ENDIF			
				CASE LOWER(ctrl.BaseClass) == "checkbox"
					IF LOWER(ALLTRIM(ctrl.cFieldName)) == LOWER(ALLTRIM(lcFieldName))
						ctrl.value = &lcReferencia
					ENDIF
				CASE LOWER(ctrl.BaseClass) == "container" .And. ALLTRIM(ctrl.Tag) == "edit"
					IF LOWER(ALLTRIM(ctrl.cFieldName)) == LOWER(ALLTRIM(lcFieldName))
						ctrl.SetValue(&lcReferencia)
					ENDIF
			ENDCASE
		ENDFOR
	ENDFOR
ENDWITH


&&Recupero los datos de la solapa "Observaciones"
SELECT cur_Tempo

WITH Thisform.Pgf.Page2.cnt_fields.internalPgf.page2
	lnCont = AFIELDS(laCampos)
	
	FOR i = 1 TO lnCont
		FOR EACH ctrl IN .Controls
			lcFieldName = laCampos[i, 1]
			lcReferencia = "cur_Tempo." + ALLTRIM(lcFieldName)

			DO CASE 
				CASE LOWER(ctrl.BaseClass) == "textbox"
					IF LOWER(ALLTRIM(ctrl.cFieldName)) == LOWER(ALLTRIM(lcFieldName)) THEN
						ctrl.value = &lcReferencia
					ENDIF			
				CASE LOWER(ctrl.BaseClass) == "combobox"
					IF LOWER(ALLTRIM(ctrl.cFieldName)) == LOWER(ALLTRIM(lcFieldName)) THEN
						ctrl.value = &lcReferencia
					ENDIF			
				CASE LOWER(ctrl.BaseClass) == "editbox"
					IF LOWER(ALLTRIM(ctrl.cFieldName)) == LOWER(ALLTRIM(lcFieldName)) THEN
						ctrl.value = &lcReferencia
					ENDIF			
				CASE LOWER(ctrl.BaseClass) == "checkbox"
					IF LOWER(ALLTRIM(ctrl.cFieldName)) == LOWER(ALLTRIM(lcFieldName)) THEN
						ctrl.value = &lcReferencia
					ENDIF
				CASE LOWER(ctrl.BaseClass) == "container" .And. ALLTRIM(ctrl.Tag) == "edit"
					IF LOWER(ALLTRIM(ctrl.cFieldName)) == LOWER(ALLTRIM(lcFieldName)) THEN
						ctrl.SetValue(&lcReferencia)
					ENDIF
			ENDCASE
		ENDFOR
	ENDFOR
ENDWITH
DODEFAULT()

&& Recupero la imagen

IF !ISNULL(cur_Tempo.linkfoto)
	Thisform.Pgf.page2.cnt_Fields.picFoto.Picture = STRTRAN(cur_Tempo.linkfoto, "\\", "\")
	Thisform.Pgf.Page2.cnt_Fields.txtPathFoto.Value = STRTRAN(cur_Tempo.linkfoto, "\\", "\")
ENDIF
ENDPROC
PROCEDURE asignarcampos
LOCAL i, cRef, cBaseClass

i = 0
cRef = ""
cBaseClass = ""

&&Asigno los campos de la solapa "Precios"
FOR i = 1 TO Thisform.Pgf.page2.cnt_fields.internalPgf.page1.ControlCount
	cBaseClass = LOWER(ALLTRIM(Thisform.Pgf.page2.cnt_fields.internalPgf.page1.Controls[i].BaseClass))
	
	IF ALLTRIM(cBaseClass) == "textbox" .OR. ALLTRIM(cBaseClass) == "editbox" .OR. ;
			ALLTRIM(cBaseClass) == "checkbox"

		cRef = "Thisform.Object_DataService." + ALLTRIM(Thisform.Pgf.page2.cnt_fields.internalPgf.page1.Controls[i].cFieldName)
		&cRef = Thisform.Pgf.page2.cnt_fields.internalPgf.page1.Controls[i].value
	ENDIF
	
	IF LOWER(ALLTRIM(Thisform.Pgf.page2.cnt_fields.internalPgf.page1.Controls[i].Class)) == "selector_tabla"
		cRef = "Thisform.Object_DataService." + ALLTRIM(Thisform.Pgf.page2.cnt_fields.internalPgf.page1.Controls[i].cFieldName)
		&cRef = Thisform.Pgf.page2.cnt_fields.internalPgf.page1.Controls[i].ValCpoID
	ENDIF
ENDFOR

&&Asigno los campos de la solapa "Observaciones"
FOR i = 1 TO Thisform.Pgf.page2.cnt_fields.internalPgf.page2.ControlCount
	cBaseClass = LOWER(ALLTRIM(Thisform.Pgf.page2.cnt_fields.internalPgf.page2.Controls[i].BaseClass))
	
	IF ALLTRIM(cBaseClass) == "textbox" .OR. ALLTRIM(cBaseClass) == "editbox" .OR. ;
			ALLTRIM(cBaseClass) == "checkbox"

		cRef = "Thisform.Object_DataService." + ALLTRIM(Thisform.Pgf.page2.cnt_fields.internalPgf.page2.Controls[i].cFieldName)
		
		IF ALLTRIM(thisform.pgf.page2.cnt_fields.internalPgf.page2.Controls[i].name) == "txtObserv" THEN
			&cRef = ""
		ENDIF
		
		&cRef = Thisform.Pgf.page2.cnt_fields.internalPgf.page2.Controls[i].value
	ENDIF
	
	IF LOWER(ALLTRIM(Thisform.Pgf.page2.cnt_fields.internalPgf.page2.Controls[i].Class)) == "selector_tabla"
		cRef = "Thisform.Object_DataService." + ALLTRIM(Thisform.Pgf.page2.cnt_fields.internalPgf.page2.Controls[i].cFieldName)
		&cRef = Thisform.Pgf.page2.cnt_fields.internalPgf.page2.Controls[i].ValCpoID
	ENDIF
ENDFOR


DODEFAULT()
ENDPROC
PROCEDURE Init
DODEFAULT()

WITH thisform.pgf.page2.cnt_fields.internalPgf.page1.cmbTipoMon
	.AddItem("PSO")
	.AddItem("DOL")
	.AddItem("EUR")
ENDWITH

Thisform.cambiar_estado_2(.T.)
ENDPROC
PROCEDURE blanquear
DODEFAULT()

WITH Thisform.Pgf.Page2.cnt_fields.internalPgf.page1
	FOR EACH ctrl IN .Controls
		DO CASE
			CASE LOWER(ctrl.BaseClass) == "textbox"
				ctrl.Blanquear()

				IF ctrl.TabIndex = 1
					ctrl.SetFocus()
				ENDIF
			CASE LOWER(ctrl.BaseClass) == "editbox"
				ctrl.Blanquear()

				IF ctrl.TabIndex = 1
					ctrl.SetFocus()
				ENDIF
			CASE LOWER(ctrl.BaseClass) == "selector_tabla"
				ctrl.Blanquear()

				IF ctrl.TabIndex = 1
					ctrl.SetFocus()
				ENDIF
			CASE LOWER(ctrl.BaseClass) == "checkbox"
				ctrl.value = 0

				IF ctrl.TabIndex = 1
					ctrl.SetFocus()
				ENDIF
			CASE LOWER(ctrl.BaseClass) == "container" .and. LOWER(ctrl.Tag) == "edit"
				ctrl.Blanquear()
				IF ctrl.TabIndex = 1
					ctrl.SetFocus()
				ENDIF
			CASE LOWER(ctrl.BaseClass) == "image"
				ctrl.picture = ""
		ENDCASE
		
	ENDFOR
ENDWITH


WITH Thisform.Pgf.Page2.cnt_fields.internalPgf.page2
	FOR EACH ctrl IN .Controls
		DO CASE
			CASE LOWER(ctrl.BaseClass) == "textbox"
				ctrl.Blanquear()

				IF ctrl.TabIndex = 1
					ctrl.SetFocus()
				ENDIF
			CASE LOWER(ctrl.BaseClass) == "editbox"
				ctrl.Blanquear()

				IF ctrl.TabIndex = 1
					ctrl.SetFocus()
				ENDIF
			CASE LOWER(ctrl.BaseClass) == "selector_tabla"
				ctrl.Blanquear()

				IF ctrl.TabIndex = 1
					ctrl.SetFocus()
				ENDIF
			CASE LOWER(ctrl.BaseClass) == "checkbox"
				ctrl.value = 0

				IF ctrl.TabIndex = 1
					ctrl.SetFocus()
				ENDIF
			CASE LOWER(ctrl.BaseClass) == "container" .and. LOWER(ctrl.Tag) == "edit"
				ctrl.Blanquear()
				IF ctrl.TabIndex = 1
					ctrl.SetFocus()
				ENDIF
			CASE LOWER(ctrl.BaseClass) == "image"
				ctrl.picture = ""
		ENDCASE
		
	ENDFOR
ENDWITH
ENDPROC
PROCEDURE validar_eliminar
&& Valida si el artículo está siendo utilizado
&& en alguna tabla relacional

LOCAL loData, lcSql

loData = CREATEOBJECT("odbc_result")

lcSql = "select idArticulo from ventasdet where idArticulo = " + ALLTRIM(STR(cur_Tempo.idarticulo))

loData.ActiveConnection = goConn.ActiveConnection
loData.Cursor_Name = "cur_Det"
loData.OpenQuery(lcSql)

SELECT cur_Det
IF RECCOUNT() > 0
	MESSAGEBOX("No se puede eliminar este artículo debido a que tiene comprobantes vinculados", 0+64, Thisform.Caption)
	RETURN .F.
ENDIF

loData.Close_Query()

RETURN .T.
ENDPROC
PROCEDURE actualizar_cursor
DODEFAULT()
SELECT cur_Tempo
LOCK()
REPLACE cur_Tempo.observ		WITH ""
REPLACE cur_Tempo.prListaExt 	WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtprExt.Value ADDITIVE
REPLACE cur_Tempo.prLista 		WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtPrLista.Value ADDITIVE
REPLACE cur_Tempo.bonif1 		WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtBonif1.Value ADDITIVE
REPLACE cur_Tempo.bonif2 		WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtBonif2.Value ADDITIVE
REPLACE cur_Tempo.bonif3 		WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtBonif3.Value ADDITIVE
REPLACE cur_Tempo.bonif4 		WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtBonif4.Value ADDITIVE
REPLACE cur_Tempo.costoRep 		WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtCostoRep.Value ADDITIVE
REPLACE cur_Tempo.margenMax 	WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtMargenMax.Value ADDITIVE
REPLACE cur_Tempo.margenMin 	WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtMargenMin.Value ADDITIVE
REPLACE cur_Tempo.prVentaMax 	WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtPrVentaMax.Value ADDITIVE
REPLACE cur_Tempo.prVentaMin 	WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtPrVentaMin.Value ADDITIVE
REPLACE cur_Tempo.prFinalMax 	WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtPrFinalMax.Value ADDITIVE
REPLACE cur_Tempo.prFinalMin 	WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page1.txtPrFinalMin.Value ADDITIVE
REPLACE cur_Tempo.observ		WITH Thisform.Pgf.Page2.Cnt_Fields.InternalPgf.Page2.txtObserv.Value ADDITIVE
UNLOCK

ENDPROC
PROCEDURE Herramientas.cmdEditar.Click
DODEFAULT()
Thisform.Pgf.Page2.Cnt_fields.txtCodigo.Enabled = .F.
ENDPROC
PROCEDURE Herramientas.nuevo
DODEFAULT()
Thisform.Cambiar_estado_2(.F.)
ENDPROC
PROCEDURE Herramientas.modificar
DODEFAULT()
Thisform.Cambiar_estado_2(.F.)
ENDPROC
PROCEDURE Herramientas.grabar
PARAMETERS tl_AutoAssing
DODEFAULT(.T.)
Thisform.Cambiar_estado_2(.T.)
RETURN .T.
ENDPROC
PROCEDURE Herramientas.cancelar
DODEFAULT()
Thisform.Cambiar_estado_2(.T.)
ENDPROC


************************************************************
OBJETO: internalPgf
************************************************************
*** PROPIEDADES ***
ErasePage = .T.
PageCount = 2
Top = 195
Left = 16
Width = 900
Height = 292
TabIndex = 10
TabStop = .T.
Name = "internalPgf"
Page1.Caption = "Precios"
Page1.Name = "Page1"
Page2.Caption = "Observaciones"
Page2.BackColor = 212,208,200
Page2.Name = "Page2"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta2
************************************************************
*** PROPIEDADES ***
Caption = "Prec. Lista Proveedor ($):"
Height = 15
Left = 18
Top = 25
Width = 148
TabIndex = 16
Name = "Clsetiqueta2"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta3
************************************************************
*** PROPIEDADES ***
Caption = "Bonificación 1:"
Left = 18
Top = 94
TabIndex = 18
Name = "Clsetiqueta3"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta4
************************************************************
*** PROPIEDADES ***
Caption = "Bonificación 2:"
Left = 18
Top = 118
TabIndex = 19
Name = "Clsetiqueta4"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta6
************************************************************
*** PROPIEDADES ***
Caption = "Bonificación 3:"
Left = 18
Top = 142
TabIndex = 20
Name = "Clsetiqueta6"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta7
************************************************************
*** PROPIEDADES ***
Caption = "Bonificación 4:"
Left = 18
Top = 166
TabIndex = 21
Name = "Clsetiqueta7"

*** METODOS ***


************************************************************
OBJETO: txtBonif1
************************************************************
*** PROPIEDADES ***
Left = 111
TabIndex = 10
Top = 90
isnumeric = .T.
cfieldname = bonif1
requerido = .F.
Name = "txtBonif1"

*** METODOS ***
PROCEDURE Valid



ENDPROC
PROCEDURE LostFocus
DODEFAULT()
thisform.calcular_precios()
ENDPROC


************************************************************
OBJETO: txtBonif2
************************************************************
*** PROPIEDADES ***
Left = 111
TabIndex = 11
Top = 114
isnumeric = .T.
requerido = .F.
cfieldname = bonif2
Name = "txtBonif2"

*** METODOS ***
PROCEDURE LostFocus
DODEFAULT()
thisform.calcular_precios()
ENDPROC


************************************************************
OBJETO: txtBonif3
************************************************************
*** PROPIEDADES ***
Left = 111
TabIndex = 12
Top = 138
isnumeric = .T.
requerido = .F.
cfieldname = bonif3
Name = "txtBonif3"

*** METODOS ***
PROCEDURE LostFocus
DODEFAULT()
thisform.calcular_precios()
ENDPROC


************************************************************
OBJETO: txtBonif4
************************************************************
*** PROPIEDADES ***
Left = 111
TabIndex = 13
Top = 162
isnumeric = .T.
requerido = .F.
cfieldname = bonif4
Name = "txtBonif4"

*** METODOS ***
PROCEDURE LostFocus
DODEFAULT()
thisform.calcular_precios()
ENDPROC


************************************************************
OBJETO: Clsetiqueta9
************************************************************
*** PROPIEDADES ***
Caption = "Costo de Reposición:"
Height = 15
Left = 18
Top = 197
Width = 123
TabIndex = 22
Name = "Clsetiqueta9"

*** METODOS ***


************************************************************
OBJETO: txtCostoRep
************************************************************
*** PROPIEDADES ***
Tag = ""
Enabled = .F.
Left = 150
TabIndex = 23
Top = 193
isnumeric = .T.
cfieldname = costoRep
requerido = .F.
Name = "txtCostoRep"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta11
************************************************************
*** PROPIEDADES ***
Caption = "Margen Mayorista:"
Height = 15
Left = 247
Top = 96
Width = 105
TabIndex = 26
Name = "Clsetiqueta11"

*** METODOS ***


************************************************************
OBJETO: txtMargenMax
************************************************************
*** PROPIEDADES ***
Left = 363
TabIndex = 14
Top = 92
isnumeric = .T.
requerido = .F.
cfieldname = margenmax
Name = "txtMargenMax"

*** METODOS ***
PROCEDURE LostFocus
DODEFAULT()
Thisform.calcular_precios()
ENDPROC


************************************************************
OBJETO: txtMargenMin
************************************************************
*** PROPIEDADES ***
Left = 363
TabIndex = 15
Top = 116
isnumeric = .T.
requerido = .F.
cfieldname = margenmin
Name = "txtMargenMin"

*** METODOS ***
PROCEDURE LostFocus
DODEFAULT()
Thisform.calcular_precios()
ENDPROC


************************************************************
OBJETO: txtPrVentaMax
************************************************************
*** PROPIEDADES ***
Tag = ""
Enabled = .F.
Left = 466
TabIndex = 27
Top = 92
isnumeric = .T.
cfieldname = prventamax
requerido = .F.
Name = "txtPrVentaMax"

*** METODOS ***


************************************************************
OBJETO: txtPrVentaMin
************************************************************
*** PROPIEDADES ***
Tag = ""
Enabled = .F.
Left = 466
TabIndex = 28
Top = 116
isnumeric = .T.
cfieldname = prventamin
requerido = .F.
Name = "txtPrVentaMin"

*** METODOS ***


************************************************************
OBJETO: txtPrFinalMax
************************************************************
*** PROPIEDADES ***
Tag = ""
Enabled = .F.
Left = 569
TabIndex = 29
Top = 92
isnumeric = .T.
cfieldname = prfinalmax
requerido = .F.
Name = "txtPrFinalMax"

*** METODOS ***


************************************************************
OBJETO: txtPrFinalMin
************************************************************
*** PROPIEDADES ***
Tag = ""
Enabled = .F.
Left = 569
TabIndex = 30
Top = 116
isnumeric = .T.
cfieldname = prfinalmin
requerido = .F.
Name = "txtPrFinalMin"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta12
************************************************************
*** PROPIEDADES ***
Caption = "Utilidad"
Height = 15
Left = 335
Top = 68
Width = 46
TabIndex = 34
Name = "Clsetiqueta12"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta13
************************************************************
*** PROPIEDADES ***
Caption = "Con I.V.A"
Height = 15
Left = 589
Top = 68
Width = 56
TabIndex = 36
Name = "Clsetiqueta13"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta18
************************************************************
*** PROPIEDADES ***
Caption = "% Dto. Prov."
Height = 15
Left = 69
Top = 68
Width = 80
TabIndex = 17
Name = "Clsetiqueta18"

*** METODOS ***


************************************************************
OBJETO: Clslinea1
************************************************************
*** PROPIEDADES ***
Height = 0
Left = 13
Top = 84
Width = 864
Name = "Clslinea1"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta19
************************************************************
*** PROPIEDADES ***
Caption = "Margen Minorista:"
Height = 15
Left = 247
Top = 119
Width = 110
TabIndex = 25
Name = "Clsetiqueta19"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta20
************************************************************
*** PROPIEDADES ***
Caption = "Sin I.V.A"
Height = 15
Left = 492
Top = 68
Width = 59
TabIndex = 35
Name = "Clsetiqueta20"

*** METODOS ***


************************************************************
OBJETO: txtprLista
************************************************************
*** PROPIEDADES ***
Left = 170
TabIndex = 9
Top = 21
isnumeric = .T.
cfieldname = prlista
requerido = .T.
Name = "txtprLista"

*** METODOS ***
PROCEDURE Valid


ENDPROC
PROCEDURE LostFocus
DODEFAULT()
thisform.calcular_precios()
ENDPROC


************************************************************
OBJETO: Clsetiqueta1
************************************************************
*** PROPIEDADES ***
Caption = "Tipo Moneda:"
Left = 361
Top = 24
Name = "Clsetiqueta1"

*** METODOS ***


************************************************************
OBJETO: cmbTipoMon
************************************************************
*** PROPIEDADES ***
Height = 22
Left = 446
ToolTipText = "PSO: Pesos | DOL: Dolares | EUR: Euros"
Top = 20
Width = 100
cfieldname = tmon
requerido = .F.
Name = "cmbTipoMon"

*** METODOS ***
PROCEDURE InteractiveChange
IF ALLTRIM(This.Value) <> "PSO" THEN 
	Thisform.PGF.Page2.Cnt_Fields.InternalPgf.Page1.txtprLista.Enabled = .F.
ELSE
	Thisform.PGF.Page2.Cnt_Fields.InternalPgf.Page1.txtprLista.Enabled = .T.
ENDIF 
ENDPROC


************************************************************
OBJETO: Clsetiqueta5
************************************************************
*** PROPIEDADES ***
Caption = "Cotización:"
Height = 15
Left = 555
Top = 24
Width = 70
Name = "Clsetiqueta5"

*** METODOS ***


************************************************************
OBJETO: txtCotizacion
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 629
Top = 20
Width = 59
isnumeric = .T.
requerido = .F.
cfieldname = cotizac
Name = "txtCotizacion"

*** METODOS ***
PROCEDURE LostFocus
DODEFAULT()

This.Parent.txtPrLista.Value = ROUND(This.Parent.txtPrExt.Value * This.Parent.txtCotizacion.Value, 2)
Thisform.calcular_precios()
ENDPROC


************************************************************
OBJETO: Clsetiqueta8
************************************************************
*** PROPIEDADES ***
Caption = "Precio Mon. Ext.:"
Height = 15
Left = 693
Top = 24
Width = 111
Name = "Clsetiqueta8"

*** METODOS ***


************************************************************
OBJETO: txtPrExt
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 797
Top = 20
Width = 59
isnumeric = .T.
requerido = .F.
cfieldname = prListaExt
Name = "txtPrExt"

*** METODOS ***
PROCEDURE LostFocus
DODEFAULT()
This.Parent.txtPrLista.Value = ROUND(This.Parent.txtPrExt.Value * This.Parent.txtCotizacion.Value, 2)
Thisform.calcular_precios()
ENDPROC


************************************************************
OBJETO: Clslinea2
************************************************************
*** PROPIEDADES ***
Height = 0
Left = 364
Top = 11
Width = 513
Name = "Clslinea2"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta10
************************************************************
*** PROPIEDADES ***
BackStyle = 1
Caption = " Moneda Extranjera"
Height = 15
Left = 357
Top = 3
Width = 149
ForeColor = 255,255,255
BackColor = 0,128,192
Name = "Clsetiqueta10"

*** METODOS ***


************************************************************
OBJETO: txtObserv
************************************************************
*** PROPIEDADES ***
Height = 132
Left = 19
TabIndex = 16
Top = 33
Width = 864
cfieldname = observ
Name = "txtObserv"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta19
************************************************************
*** PROPIEDADES ***
Caption = "Observaciones:"
Height = 15
Left = 20
Top = 13
Width = 110
TabIndex = 25
Name = "Clsetiqueta19"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta1
************************************************************
*** PROPIEDADES ***
Caption = "Código:"
Height = 15
Left = 291
Top = 19
Width = 72
TabIndex = 12
Name = "Clsetiqueta1"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta2
************************************************************
*** PROPIEDADES ***
Caption = "Descripción:"
Height = 15
Left = 265
Top = 43
Width = 76
TabIndex = 13
Name = "Clsetiqueta2"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta3
************************************************************
*** PROPIEDADES ***
Caption = "Familia:"
Height = 15
Left = 292
Top = 67
Width = 44
TabIndex = 14
Name = "Clsetiqueta3"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta4
************************************************************
*** PROPIEDADES ***
Caption = "SubFamilia:"
Height = 15
Left = 271
Top = 91
Width = 65
TabIndex = 15
Name = "Clsetiqueta4"

*** METODOS ***


************************************************************
OBJETO: txtCodigo
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 343
MaxLength = 20
TabIndex = 1
Top = 15
Width = 283
ischaracter = .T.
cfieldname = CodArt
msgerror = Debe ingresar el Código del Artículo
Name = "txtCodigo"

*** METODOS ***


************************************************************
OBJETO: txtDescripcion
************************************************************
*** PROPIEDADES ***
Height = 21
Left = 343
MaxLength = 100
TabIndex = 2
Top = 39
Width = 571
ischaracter = .T.
cfieldname = Descripcio
msgerror = Debe ingresar la Descripción
Name = "txtDescripcion"

*** METODOS ***


************************************************************
OBJETO: sel_Familia
************************************************************
*** PROPIEDADES ***
Top = 61
Left = 341
Width = 573
Height = 25
TabIndex = 3
nombre_tabla = familias
nombre_campo_codigo = idfamilia
nombre_campo_desc = descripcio
cfieldname = idfamilia
esnumerico = .T.
pkfield = idfamilia
msgerror = Debe seleccionar una Familia
Name = "sel_Familia"
txtCodigo.Name = "txtCodigo"
txtDescripcion.Height = 21
txtDescripcion.Left = 106
txtDescripcion.Top = 2
txtDescripcion.Width = 467
txtDescripcion.Name = "txtDescripcion"

*** METODOS ***


************************************************************
OBJETO: picFoto
************************************************************
*** PROPIEDADES ***
Height = 120
Left = 45
Top = 8
Width = 140
cfieldname = 
Name = "picFoto"

*** METODOS ***


************************************************************
OBJETO: btnCargarFoto
************************************************************
*** PROPIEDADES ***
Tag = "edit"
Top = 131
Left = 16
Height = 25
Width = 202
Caption = "Cargar Foto"
TabIndex = 11
Name = "btnCargarFoto"

*** METODOS ***
PROCEDURE Click
LOCAL lcPath

lcPath = GETFILE("JPG")

IF ALLTRIM(lcPath) == ""
	RETURN	
ENDIF

This.Parent.picFoto.Picture = lcPath
This.Parent.txtPathFoto.Value = STRTRAN(lcPath, "\", "\\")




ENDPROC


************************************************************
OBJETO: Clsetiqueta5
************************************************************
*** PROPIEDADES ***
Caption = "Marca:"
Height = 15
Left = 297
Top = 114
Width = 44
TabIndex = 17
Name = "Clsetiqueta5"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta6
************************************************************
*** PROPIEDADES ***
Caption = "Proveedor:"
Height = 15
Left = 272
Top = 138
Width = 69
TabIndex = 16
Name = "Clsetiqueta6"

*** METODOS ***


************************************************************
OBJETO: Sel_SubFamilia
************************************************************
*** PROPIEDADES ***
Top = 85
Left = 341
Width = 573
Height = 25
TabIndex = 4
nombre_tabla = subfam
nombre_campo_codigo = idsubfam
nombre_campo_desc = descripcio
cfieldname = idsubfam
esnumerico = .T.
pkfield = idsubfam
msgerror = Debe seleccionar una SubFamilia
Name = "Sel_SubFamilia"
txtCodigo.Name = "txtCodigo"
txtDescripcion.Height = 21
txtDescripcion.Left = 106
txtDescripcion.Top = 2
txtDescripcion.Width = 467
txtDescripcion.Name = "txtDescripcion"

*** METODOS ***


************************************************************
OBJETO: Sel_Marca
************************************************************
*** PROPIEDADES ***
Top = 109
Left = 341
Width = 573
Height = 25
TabIndex = 5
nombre_tabla = marcas
nombre_campo_codigo = idmarca
nombre_campo_desc = descripcio
cfieldname = idmarca
esnumerico = .T.
pkfield = idmarca
msgerror = Debe seleccionar una Marca
Name = "Sel_Marca"
txtCodigo.Name = "txtCodigo"
txtDescripcion.Height = 21
txtDescripcion.Left = 106
txtDescripcion.Top = 2
txtDescripcion.Width = 467
txtDescripcion.Name = "txtDescripcion"

*** METODOS ***


************************************************************
OBJETO: Sel_Proveedor
************************************************************
*** PROPIEDADES ***
Top = 133
Left = 341
Width = 573
Height = 25
TabIndex = 6
nombre_tabla = proveedor
nombre_campo_codigo = idprov
nombre_campo_desc = razsoc
cfieldname = idprov
esnumerico = .T.
pkfield = idprov
msgerror = Debe seleccionar un Proveedor
Name = "Sel_Proveedor"
txtCodigo.Name = "txtCodigo"
txtDescripcion.Height = 21
txtDescripcion.Left = 106
txtDescripcion.Top = 2
txtDescripcion.Width = 467
txtDescripcion.Name = "txtDescripcion"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta7
************************************************************
*** PROPIEDADES ***
Caption = "Alícuota I.V.A.:"
Left = 256
Top = 163
TabIndex = 18
Name = "Clsetiqueta7"

*** METODOS ***


************************************************************
OBJETO: txtAlicIVA
************************************************************
*** PROPIEDADES ***
Left = 343
TabIndex = 7
Top = 159
isnumeric = .T.
cfieldname = aliciva
msgerror = Debe ingresar la Alícuota de I.V.A.
Name = "txtAlicIVA"

*** METODOS ***


************************************************************
OBJETO: chkHabilitado
************************************************************
*** PROPIEDADES ***
Top = 161
Left = 469
Height = 18
Width = 79
Alignment = 0
Caption = " Habilitado"
Value = 1
TabIndex = 8
cfieldname = habilitado
requerido = .T.
Name = "chkHabilitado"

*** METODOS ***


************************************************************
OBJETO: Clsetiqueta8
************************************************************
*** PROPIEDADES ***
Caption = "%"
Height = 15
Left = 446
Top = 163
Width = 12
TabIndex = 19
Name = "Clsetiqueta8"

*** METODOS ***


************************************************************
OBJETO: txtPathFoto
************************************************************
*** PROPIEDADES ***
Height = 22
Left = 18
MaxLength = 100
TabIndex = 20
Top = 158
Width = 199
cfieldname = linkfoto
ischaracter = .T.
requerido = .F.
Name = "txtPathFoto"

*** METODOS ***


************************************************************
OBJETO: chkEsServicio
************************************************************
*** PROPIEDADES ***
Top = 161
Left = 600
Height = 18
Width = 110
Alignment = 0
Caption = "Es un servicio"
Value = 1
TabIndex = 9
cfieldname = esServ
requerido = .T.
Name = "chkEsServicio"

*** METODOS ***


************************************************************
OBJETO: 
************************************************************
*** PROPIEDADES ***
Arial, 0, 8, 5, 14, 11, 29, 3, 0
Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 1, 8, 5, 14, 11, 29, 3, 0

*** METODOS ***


